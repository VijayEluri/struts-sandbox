<?xml version="1.0" encoding="utf-8" ?> 

<sqlMap 
	namespace="PhoneBook" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:noNamespaceSchemaLocation="SqlMap.xsd" >
	
    <parameterMaps>
		
   		<parameterMap id="entry_save_param">
			<parameter property="last_name"/>
			<parameter property="first_name"/>
			<parameter property="extension"/>
			<parameter property="user_name"/>
			<parameter property="hired"/>
			<parameter property="hours"/>
			<parameter property="editor"/>
   			<parameter property="entry_key"/>   		
        </parameterMap>    		
  	
  	</parameterMaps>
		
	<statements>
		<select id="filter" paramClass="Hashtable" resultClass="Hashtable">
			SELECT 
				last_name,
				first_name,
				extension,
				user_name,
				hired,
				hours,
				editor,
				pk_entry AS entry_key				
			FROM entry
			<dynamic prepend="WHERE">			
				<isNotNull property="last_name" prepend="AND">
					last_name=#last_name#
				</isNotNull>
				<isNotNull property="first_name" prepend="AND">
					first_name=#first_name#
				</isNotNull>
				<isNotNull property="extension" prepend="AND">
					extension=#extension#
				</isNotNull>
				<isNotNull property="user_name" prepend="AND">
					user_name=#user_name#
				</isNotNull>
				<isNotNull property="hired" prepend="AND">
					hired=#hired#
				</isNotNull>
				<isNotNull property="hours" prepend="AND">
					hours=#hours#
				</isNotNull>
				<isNotNull property="editor" prepend="AND">
					hours=#editor#
				</isNotNull>
				<isNotNull property="entry_key" prepend="AND">
					pk_entry=#entry_key#
				</isNotNull>
			</dynamic>			
		</select>

		<insert id="entry_insert" parameterMap="entry_save_param">
    		INSERT INTO entry (    			
				last_name,
				first_name,
				extension,
				user_name,
				hired,
				hours,
				pk_entry
				)
			VALUES (?,?,?,?, ?,?,?)
		</insert>		

		<update id="entry_update" parameterMap="entry_save_param">
			UPDATE entry SET
				last_name=?,
				first_name=?,
				extension=?,
				user_name=?,
				hired=?,
				hours=?
			WHERE 
				pk_entry=?
		</update>
						
	</statements>
	
</sqlMap>
